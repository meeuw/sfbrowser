(function(e){var s;var x;var y;var j;var l;var r;var g;var i;var t;var a;var w;var p;var c;var f;var k;var u;var h;var m;var b;var q;var d;e.fn.extend(e.sfbrowser,{createascii:function(A){s=A.trace;x=A.file;y=A.lang;j=A.onError;addContextItem=A.addContextItem;r=A.aPath;i=A.oTree;g=A.oSettings;t=A.mSfb;a=A.oReg;moveWindowDown=A.moveWindowDown;l=A.listAdd;d=g.sfbpath+"plugins/createascii/connectors/"+g.connector+"/createascii."+g.connector;var B="<div>"+g.createascii+"</div>";var z=e(B);c=z.find(">ul>li:first").prependTo(t.find("#sfbtopmenu")).click(o);c.find("a>span").text(g.lang.asciiFileNew);f=z.find("#sfbcreateascii").appendTo(t.find("#fbwin")).hide();f.find(".cancel").click(n);f.find(".submit").click(v);k=f.find("input");u=f.find("select");h=f.find("textarea");f.find("label[for=filename]").text(g.lang.filename+": ");f.find("label[for=fileext]").text(g.lang.filetype+": ");f.find("label[for=filecont]").text(g.lang.contents+": ");e(g.ascii).each(function(C,D){if(g.deny.indexOf(0)<0){u.append('<option value="'+D+'">&nbsp; '+D+"</option>")}});f.find("div.sfbheader>h3").mousedown(moveWindowDown);b=addContextItem("editascii",g.lang.asciiFileSave,function(){o()},0)}});e.extend(e.sfbrowser.createascii,{resizeWindow:function(A,z){h.width(A-30).height(z-h.position().top-45)},checkContextItem:function(z){b.css({display:g.ascii.indexOf(z.mime)>=0?"block":"none"})}});function o(A){q=A!=null;f.find("h3").text(q?g.lang.asciiFileNew:g.lang.asciiFileSave);f.find(".submit").text(q?g.lang.create:g.lang.save);if(q){h.text("");p=null}else{p=x();e.ajax({type:"POST",url:d,data:"a=cont&folder="+r.join("")+"&file="+p.file,dataType:"json",success:function(C,B){if(typeof(C.error)!="undefined"){if(C.error!=""){alert(y(C.error))}else{h.text(C.data.text)}}}})}var z={display:q?"inline":"none"};e("[for=filename],[for=fileext],[name=filename],[name=fileext]").css(z);e("#winbrowser").hide();f.show()}function n(z){f.hide();e("#winbrowser").show()}function v(D){var F=k.val();var C=u.val();var B=h.val();var E=F+"."+C;var z=true;if(q){if(F==""||F.match(a.fileNameNoExt)){alert(g.lang.axciiFileNameInvalid);z=false}}else{if(m==B){s("No changes were made.");n();z=false}}if(z){var A="a="+(q?"new":"edit")+"&folder="+r.join("")+"&file="+(q?E:p.file)+"&contents="+B;e.ajax({type:"POST",url:d,data:A,dataType:"json",error:j,success:function(H,G){if(typeof(H.error)!="undefined"){if(H.error!=""){alert(y(H.error))}else{if(H.data.file){l(H.data,1)}n()}}}})}}})(jQuery);